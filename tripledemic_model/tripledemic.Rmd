---
title: "Tripledemic Model"
author: "Alyssa Anastasi"
date: "2025-08-05"
output: html_document
---

# Setup
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(deSolve)
library(tidyverse)
library(MetBrewer)
library(directlabels)
library(cowplot)
library(viridis)
library(RColorBrewer)
library(ggrepel)
library(spatstat.utils)
library(paletteer)
library(bbmle)
library(mgcv)
source("seir_params.R")
source("seir.R")
source("tripledemic_source.R")
```

# Tripledemic Scenario

## No Vaccination
```{R}
df_novac <- run_ode(init=init, seir_fn=seir, times=times, parms=novac_parms)
```

```{R}
novac_plot_ct <- plot_infections_count_by_vacc(df_novac, 3650, novac=TRUE)
# novac_plot_ct
# save_plot(novac_plot_ct, "novac_ct")
# novac_plot_pct <- plot_infections_percent_by_vacc(df_novac, 400, novac=TRUE) 
# save_plot(novac_plot_pct, "novac_pct")
# novac_overall <- plot_percent_total_infections(df_novac)
# novac_hosp <- plot_hosp_count_by_vacc(df_novac, 400, novac=TRUE)
novac_plot_ct
# novac_deaths <- plot_cum_deaths(df_novac, novac=TRUE)
# save_plot(novac_deaths, "novac_deaths")
# novac_deaths
plot_total_infections(df_novac)
```
## Current Vaccination
```{R}
df_currvac <- run_ode(init=init, seir_fn=seir, times=times, parms=currvac_parms)
```

```{r}
currvac_plot_ct <- plot_infections_count_by_vacc(df_currvac, 400)
save_plot(currvac_plot_ct, "currvac_ct", 6, 4)
currvac_plot_pct <- plot_infections_percent_by_vacc(df_currvac, 400)
save_plot(currvac_plot_pct, "currvac_pct", 6, 4)
currvac_overall <- plot_percent_total_infections(df_currvac)
save_plot(currvac_overall, "currvac_overall", 6, 4)
currvac_hosp <- plot_hosp_count_by_vacc(df_currvac, 400)
currvac_deaths <- plot_cum_deaths(df_currvac)
save_plot(currvac_deaths, "currvac_deaths", 6, 4)
```

## Four Scenarios

### Seniors

# Testing

```{R}
grouped_df <- df_novac %>% filter(type=="Infected") %>%
    group_by(disease_group, time) %>%
    summarise(total = sum(value))
grouped_df$percent <- grouped_df$total / PopT
grouped_df
```